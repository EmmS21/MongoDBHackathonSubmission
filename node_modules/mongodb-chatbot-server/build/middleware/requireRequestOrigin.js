"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requireRequestOrigin = exports.CUSTOM_REQUEST_ORIGIN_HEADER = void 0;
const utils_1 = require("../utils");
exports.CUSTOM_REQUEST_ORIGIN_HEADER = "X-Request-Origin";
function requireRequestOrigin() {
    return (req, res, next) => {
        const reqId = (0, utils_1.getRequestId)(req);
        const origin = req.header("origin");
        const customOrigin = req.header(exports.CUSTOM_REQUEST_ORIGIN_HEADER);
        const requestOrigin = customOrigin || origin;
        if (!requestOrigin) {
            return (0, utils_1.sendErrorResponse)({
                reqId,
                res,
                httpStatus: 400,
                errorMessage: `You must specify either an Origin or ${exports.CUSTOM_REQUEST_ORIGIN_HEADER} header`,
            });
        }
        res.locals.customData.origin = requestOrigin;
        (0, utils_1.logRequest)({
            reqId,
            message: `Request origin ${requestOrigin} is allowed`,
        });
        next();
    };
}
exports.requireRequestOrigin = requireRequestOrigin;
//# sourceMappingURL=requireRequestOrigin.js.map